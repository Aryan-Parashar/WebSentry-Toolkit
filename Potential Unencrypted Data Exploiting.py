import requests
from bs4 import BeautifulSoup, Tag
import pyfiglet

ascii_banner = pyfiglet.figlet_format("UNENCRYPTED DATA EXPLOITATION")
print(ascii_banner)

def test_unencrypted_data_storage(url):
    try:
        response = requests.get(url, headers={'User-Agent': 'Mozilla/5.0'})
        if response.status_code == 200:
            soup = BeautifulSoup(response.content, 'html.parser')
            
            potential_areas = []

            # Look for forms
            forms = soup.find_all('form')
            if forms:
                potential_areas.extend(forms)

            # Look for input fields
            input_fields = soup.find_all('input')
            if input_fields:
                potential_areas.extend(input_fields)

            # Look for URLs with sensitive information
            sensitive_urls = ['login', 'register', 'checkout', 'profile', 'admin', 'account', 'billing', 'payment']
            if any(sensitive_url in url.lower() for sensitive_url in sensitive_urls):
                potential_areas.append(url)

            if potential_areas:
                print("[+] Potential unencrypted data storage detected on the website:")
                for area in potential_areas:
                    print("  - Detected in:", area)
                    explore_further = input("Would you like to explore further this area? (Yes/No): ")
                    if explore_further.lower() == 'yes':
                        if isinstance(area, str):
                            area_response = requests.get(area, headers={'User-Agent': 'Mozilla/5.0'})
                            if area_response.status_code == 200:
                                print("    - Content retrieved from area:")
                                print(area_response.content)
                            else:
                                print("    - Failed to retrieve content from area.")
                        elif isinstance(area, Tag) and area.name == 'form':
                            form_inputs = area.find_all('input')
                            if form_inputs:
                                print("    - Input fields in the form:")
                                for input_field in form_inputs:
                                    print("        -", input_field)
                            else:
                                print("    - No input fields found in the form.")
                explore_further_global = input("Would you like to explore other potential areas? (Yes/No): ")
                if explore_further_global.lower() == 'yes':
                    # Implement global further exploration here
                    pass
            else:
                print("[-] No potential unencrypted data storage detected on the website.")
        else:
            print("[-] Failed to retrieve content from the website.")
    except Exception as e:
        print("[-] An error occurred:", e)

# Main function
def main():
    print("Unencrypted Data Storage Vulnerability Tester")
    print("This program assesses a given website for potential unencrypted data storage vulnerabilities.")
    target_website = input("Enter the URL of the website to test: ")
    print(f"Evaluating {target_website} for unencrypted data storage vulnerabilities...")
    test_unencrypted_data_storage(target_website)

if __name__ == "__main__":
    main()
