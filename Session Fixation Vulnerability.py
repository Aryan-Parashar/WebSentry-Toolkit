import requests
import pyfiglet
from colorama import Fore, Style

def test_session_fixation_vulnerability(target_url):
    session = requests.Session()
    response = session.get(target_url)
    
    # Extracting cookies from the response
    cookies = response.headers.get('Set-Cookie')

    # Displaying the response status code
    print(f"\n{Fore.YELLOW}Response Status Code:{Style.RESET_ALL} {response.status_code}")
    
    # Displaying the Set-Cookie header in the response
    print(f"{Fore.YELLOW}Set-Cookie Header:{Style.RESET_ALL} {cookies}")
    
    # Analyzing session ID presence
    if "sessionid" in cookies.lower():
        print(f"\n{Fore.RED}Warning: Session ID present in Set-Cookie header. Potential Session Fixation Vulnerability!{Style.RESET_ALL}")
        vulnerability_level = "high"
    else:
        print(f"\n{Fore.GREEN}No session ID found in Set-Cookie header. No apparent Session Fixation Vulnerability.{Style.RESET_ALL}")
        vulnerability_level = "low"
    
    return vulnerability_level

if __name__ == "__main__":
    from colorama import init
    init(autoreset=True)
    
    ascii_banner = pyfiglet.figlet_format("SESSION FIXATION")
    print(ascii_banner)
    
    print(f"{Fore.CYAN}Python Session Fixation Vulnerability Tester{Style.RESET_ALL}")
    
    # Asking user for the target website URL
    target_url = input("\nEnter the URL of the target website: ")
    
    # Testing the session fixation vulnerability
    vulnerability_level = test_session_fixation_vulnerability(target_url)  
    print(f"\n{Fore.CYAN}Vulnerability Level: {vulnerability_level.capitalize()}{Style.RESET_ALL}")
